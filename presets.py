#Settings for running a spider against mutillidae to get mostly relevant pages
#with few duplicates and without damaging the site
MUTILLIDAE_SPIDER = {
    'start_url': 'http://127.0.0.1/mutillidae/',
    'domain': '127.0.0.1/mutillidae/',
    'deny_strs': ['mutillidae/includes', 'mutillidae/webservices', '#', '.pdf', 'set-up-database', 'hints-page-wrapper', 'phpmyadmin'],
    'param_restricted': 'page',
    'urls_file_name': 'output/urls_spidered.txt'
}

#the list of presets for spiders (just mutillidae at this time)
presets_spider = {
    'MUTILLIDAE_SPIDER': MUTILLIDAE_SPIDER
}

#Return a list of string representations of available presets
def get_presets_strings(pre_type):
    if pre_type == 'spider':
        strings = []
        for k in presets_spider:
            strings.append(presets_spider_to_string(k, presets_spider[k]) + '\n')
        return strings

#Make a string of the details of a preset
def presets_spider_to_string(name, preset):
    string = name + ':\n'
    string += 'Start url: {0}\tDomain: {1}\tOutput file: {4}\nDenied strings: {2}\nRestricted parameter: {3}'.format(
                preset['start_url'], preset['domain'], str(preset['deny_strs']), preset['param_restricted'], preset['urls_file_name'])
    return string

#return a preset based on the name
def get_preset_spider(preset_name):
    return presets_spider[preset_name]

#Get a list of all of the names of presets available
def get_presets_spider_list():
    return presets_spider.keys()
