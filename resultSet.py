import result

#A class describing an object that is a collection of result objects
class ResultSet:
    #The list of resul objects
    results_list = []

    #Add a result to the list
    def add(self, result):
        self.results_list.append(result)

    #returns a string formatted to a table style structure containing
    #the data of all results in the set
    def to_string(self):
        results_text_arr = []
        #Make a headings line
        results_text_str = '\n{0} {1} {2} {3}\n{4}\n'.format('Time'.ljust(20),
            'URL'.ljust(80), 'Attack'.ljust(30), 'Success/Failure', ('-' * 148))
        #Loop through the results and add the string representation of each one
        for result in self.results_list:
            results_text_arr.append(result.to_string())
        results_text_str += '\n'.join(results_text_arr)
        results_text_str += "\n"
        return results_text_str

    #Output the results to a text file, in a table-like format
    def out_to_text_file(self, results_file_name=None):
        #get the string representation of the resultset
        results_text_str = self.to_string()
        #try to open the file and append the results
        try:
            if(results_file_name == None):
                results_file_name = "output/results.txt"
            results_file = open(results_file_name, "a+")
            results_file.write(results_text_str)
            results_file.close()
            return "Results written to " + results_file_name
        except Exception as e:
            return "Failed to write results to " + results_file_name
